<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.demo2.mapper.AccountMapper">

    <!-- 查询所有 -->
    <!-- id 用于指定接口中的方法名 -->
    <!-- resultType 用于指定返回结果类型 -->
    <select id="findAll" resultType="com.demo2.pojo.Account">
        select * from tb_account
    </select>

    <!-- 根据 id 查询 -->
    <!-- parameterType 用于指定入参数类型 -->
    <!--
        #{} 是 PreparedStatement 中的占位符，
        如果是基本类型或 String 类型，可以任意指定
        如果是 pojo 类型，则需要对应 属性名
     -->
    <select id="findById" parameterType="int" resultType="com.demo2.pojo.Account">
        select * from tb_account where id = #{accountId}
    </select>

    <!-- 保存方法 -->
    <insert id="saveAccount" parameterType="com.demo2.pojo.Account">
        <!-- 获取插入的id -->
        <selectKey keyProperty="id" keyColumn="id" resultType="int" order="AFTER">
            select last_insert_id();
        </selectKey>
        insert into tb_account(name,money) values (#{name},#{money})
    </insert>

    <!-- 更新方法 -->
    <update id="updateAccount" parameterType="com.demo2.pojo.Account">
        update tb_account set money=#{money} where name = #{name}
    </update>

    <!-- 删除方法 -->
    <delete id="deleteAccount" parameterType="java.lang.Integer">
        delete from tb_account where id = #{accountId}
    </delete>

    <!-- 模糊查询 -->
    <!--
        ${} 是 Statement 的字符串拼接
        可以使用 %${value}% 拼接 %
        如果是非数字类型，需要加上单引号
        这种写法会有 sql 注入问题，实际开发中会使用 bind 标签来拼接 %，具体可以查看官方文档 动态 sql 章节。
    -->
    <!--
        <bind name="name" value="'%' + name + '%'"/>
        select * from tb_account where name like #{name}
    -->
    <select id="findByName" parameterType="string" resultType="com.demo2.pojo.Account">
        select * from tb_account where name like '%${name}%'
    </select>

    <!-- 使用聚合函数查询记录总数 -->
    <select id="findTotal" resultType="int">
        select count(id) from tb_account
    </select>

    <!-- 多参数查询 -->
    <select id="findByNameAndMoney" resultType="com.demo2.pojo.Account">
        select * from tb_account where name like '%${name}%' and money > #{money}
    </select>
</mapper>